<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="prev" title="Radio Delivery" href="radio-delivery.html" />

    <!-- Generated with Sphinx 6.0.0 and Furo 2022.12.07 -->
        <title>Development - MDS Server documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">MDS Server  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">MDS Server  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="general-http-api.html">General HTTP API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-gateway.html">API Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="websocket.html">WebSocket</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-management.html">Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="permissions.html">Permissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="operations.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="groups.html">Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="address-book.html">Address Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="intelligence.html">Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="in-app-notifications.html">In-App Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="radio-delivery.html">Radio Delivery</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Development</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="development">
<h1>Development<a class="headerlink" href="#development" title="Permalink to this heading">#</a></h1>
<p>This chapter provides instructions in order to explain the development setup with MDS Server.
As MDS Server is meant to be deployed on a Kubernetes cluster, local development requires some adjustments.
Here, we describe usage with <a class="reference external" href="https://www.docker.com/">Docker</a>, <a class="reference external" href="https://minikube.sigs.k8s.io/">minikube</a>, <a class="reference external" href="https://skaffold.dev/">Skaffold</a> and <a class="reference external" href="https://plugins.jetbrains.com/plugin/8079-cloud-code">IntelliJ Cloud Code Plugin</a>.</p>
<section id="setup-project">
<h2>Setup Project<a class="headerlink" href="#setup-project" title="Permalink to this heading">#</a></h2>
<p>MDS Server source code is stored in a <a class="reference external" href="https://github.com/mobile-directing-system/mds-server">GitHub Repository</a>.
If you want to contribute, create a fork and checkout the repository locally using <a class="reference external" href="https://git-scm.com/">Git</a>.
If you only want to run the server, you can clone the regular repository with:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/mobile-directing-system/mds-server.git
</pre></div>
</div>
<p>From now on, we expect you to use the repository root as your working directory.</p>
</section>
<section id="setup-docker">
<h2>Setup Docker<a class="headerlink" href="#setup-docker" title="Permalink to this heading">#</a></h2>
<p>Docker provides needed containerization for services.
For installation instructions refer to the Docker documentation <a class="reference external" href="https://docs.docker.com/get-docker/">here</a>.</p>
</section>
<section id="setup-minikube">
<h2>Setup minikube<a class="headerlink" href="#setup-minikube" title="Permalink to this heading">#</a></h2>
<p>First, you need to install minikube.
Installation instructions for your operating system are available <a class="reference external" href="https://minikube.sigs.k8s.io/docs/start/">here</a>.
Then we need to start a cluster:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>minikube<span class="w"> </span>start
</pre></div>
</div>
<p>You can also launch the Kubernetes dashboard by running:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>minikube<span class="w"> </span>dashboard
</pre></div>
</div>
</section>
<section id="prepare-deployment">
<h2>Prepare deployment<a class="headerlink" href="#prepare-deployment" title="Permalink to this heading">#</a></h2>
<p>Kubernetes uses YAML-files for deploying configurations.
Skaffold simplifies working with these files as well as building Docker images, etc.
When developing in JetBrains IDEs like <a class="reference external" href="https://www.jetbrains.com/go/">GoLand</a>, you can use the <a class="reference external" href="https://plugins.jetbrains.com/plugin/8079-cloud-code">IntelliJ Cloud Code Plugin</a>.
Detailed usage instructions are available <a class="reference external" href="https://cloud.google.com/code/docs/intellij/install">here</a>.
However, we will explain the approach with using Skaffold manually.</p>
<p>First make sure that Skaffold is installed. Installation instructions can be found <a class="reference external" href="https://skaffold.dev/docs/install/">here</a>.</p>
<p>The Skaffold configuration provides two relevant profiles: <cite>prepare</cite> and <cite>mds</cite>.
Due to Skaffold’s nature, we can only apply all referenced YAML-files at once.
However, CRDs for example need to be applied and then processed by Kubernetes until it can understand the files, that rely on them.
This also applies to NGINX configurations.
Therefore, the <cite>prepare</cite>-profile provides basic setup for resources as well as NGINX deployments and the <cite>mds</cite>-profile includes the rest of the actual server application.
Normally, the <cite>prepare</cite>-profile needs to be deployed exactly once after a new Kubernetes was created with minikube.
For deploying the profile, execute the following command:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>skaffold<span class="w"> </span>deploy<span class="w"> </span>--profile<span class="o">=</span>prepare
</pre></div>
</div>
<p>Now everything is setup for the actual deployment of MDS Server.</p>
</section>
<section id="deploy-for-development-using-skaffold">
<h2>Deploy for development using Skaffold<a class="headerlink" href="#deploy-for-development-using-skaffold" title="Permalink to this heading">#</a></h2>
<p>For actually deploying MDS Server, we need to build required Docker images as well as deploy everything to Kubernetes.
This job is handled by Skaffold.
Run from the working directory:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>skaffold<span class="w"> </span>dev<span class="w"> </span>--profile<span class="o">=</span>mds
</pre></div>
</div>
<p>This will build all Docker images and deploy to the Kubernetes cluster.
Skaffold will keep running.
For stopping MDS Server, simply press <code class="docutils literal notranslate"><span class="pre">CTRL+C</span></code>.
This will make Skaffold remove all applied configurations and make Kubernetes shut down all components.</p>
<p>We expect you to be running minikube as Docker container.
In order to access services provided by MDS Server, you need to find the minikube IP address as well as the port number.
This can be achieved by running the following command:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>minikube<span class="w"> </span>service<span class="w"> </span>list
</pre></div>
</div>
<p>This will return something like the following:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="p">|</span>------------------------<span class="p">|</span>---------------------------------------------<span class="p">|</span>--------------<span class="p">|</span>---------------------------<span class="p">|</span>
<span class="p">|</span><span class="w">       </span>NAMESPACE<span class="w">        </span><span class="p">|</span><span class="w">                    </span>NAME<span class="w">                     </span><span class="p">|</span><span class="w"> </span>TARGET<span class="w"> </span>PORT<span class="w">  </span><span class="p">|</span><span class="w">            </span>URL<span class="w">            </span><span class="p">|</span>
<span class="p">|</span>------------------------<span class="p">|</span>---------------------------------------------<span class="p">|</span>--------------<span class="p">|</span>---------------------------<span class="p">|</span>
<span class="p">|</span><span class="w"> </span>default<span class="w">                </span><span class="p">|</span><span class="w"> </span>kubernetes<span class="w">                                  </span><span class="p">|</span><span class="w"> </span>No<span class="w"> </span>node<span class="w"> </span>port<span class="w"> </span><span class="p">|</span>
...
<span class="p">|</span><span class="w"> </span>kafka<span class="w">                  </span><span class="p">|</span><span class="w"> </span>kafka-cluster-zookeeper-nodes<span class="w">               </span><span class="p">|</span><span class="w"> </span>No<span class="w"> </span>node<span class="w"> </span>port<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>kafka<span class="w">                  </span><span class="p">|</span><span class="w"> </span>kafka-ui-service<span class="w">                            </span><span class="p">|</span><span class="w"> </span>http/30010<span class="w">   </span><span class="p">|</span><span class="w"> </span>http://192.168.49.2:31847<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>kube-system<span class="w">            </span><span class="p">|</span><span class="w"> </span>kube-dns<span class="w">                                    </span><span class="p">|</span><span class="w"> </span>No<span class="w"> </span>node<span class="w"> </span>port<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>public-ingress-nginx<span class="w">   </span><span class="p">|</span><span class="w"> </span>public-ingress-nginx-controller<span class="w">             </span><span class="p">|</span><span class="w"> </span>http/30080<span class="w">   </span><span class="p">|</span><span class="w"> </span>http://192.168.49.2:30080<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">                        </span><span class="p">|</span><span class="w">                                             </span><span class="p">|</span><span class="w"> </span>https/30443<span class="w">  </span><span class="p">|</span><span class="w"> </span>http://192.168.49.2:30443<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>public-ingress-nginx<span class="w">   </span><span class="p">|</span><span class="w"> </span>public-ingress-nginx-controller-admission<span class="w">   </span><span class="p">|</span><span class="w"> </span>No<span class="w"> </span>node<span class="w"> </span>port<span class="w"> </span><span class="p">|</span>
<span class="p">|</span>------------------------<span class="p">|</span>---------------------------------------------<span class="p">|</span>--------------<span class="p">|</span>---------------------------<span class="p">|</span>
</pre></div>
</div>
<p>From the information provided, we can access the servers HTTP service at <cite>http://192.168.49.2:30080</cite>.
The IP address is also shown when running:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>minikube<span class="w"> </span>ip
</pre></div>
</div>
<p>If you want to, you can create a new entry in <cite>/etc/hosts</cite> file with your minikube IP address:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">192.168.49.2</span> <span class="n">minikube</span>
</pre></div>
</div>
<p>This allows you accessing the HTTP service via <cite>http://minikube:30080</cite>.</p>
</section>
<section id="if-something-goes-wrong">
<h2>If something goes wrong<a class="headerlink" href="#if-something-goes-wrong" title="Permalink to this heading">#</a></h2>
<p>Due to some bugs, sometimes resources might not get cleaned up or the cluster is in an unexpected state.
In this case, a hard reset can be performed by running:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>minikube<span class="w"> </span>delete
</pre></div>
</div>
<p>Keep in mind, that in order to deploy again, you need to deploy the <cite>prepare</cite>-profile again as well as described in this chapter.</p>
</section>
<section id="viewing-logs">
<h2>Viewing logs<a class="headerlink" href="#viewing-logs" title="Permalink to this heading">#</a></h2>
<p>Logs can be either viewed through the Kubernetes dashboard by navigating to the desired pod and it’s logs or through Kibana.
Part of the deployment is <a class="reference external" href="https://fluentbit.io/">Fluent Bit</a>, which allows centralized logging.
It forwards processed log entries to Elasticsearch.
Results can be viewed in Kibana, accessible via <cite>http://minikube:30090</cite>.
Upon first start do the following:</p>
<ul class="simple">
<li><p>Open the sidebar to the left.</p></li>
<li><p>Under <cite>Analytics</cite>, click <cite>Discover</cite>.</p></li>
<li><p>Click <cite>Create data view</cite>.</p></li>
<li><p>Click <cite>Create data view</cite>.</p></li>
</ul>
<p>You can now view logs using the <cite>Discover</cite>-button on the left toolbar (the compass-icon).
If you only want to see logs from MDS pods, type <code class="docutils literal notranslate"><span class="pre">kubernetes.pod_name</span> <span class="pre">:</span> <span class="pre">mds*</span></code> in the search bar.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="radio-delivery.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Radio Delivery</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Yves Haas, Laurin Todt, Lennart Altenhof
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Development</a><ul>
<li><a class="reference internal" href="#setup-project">Setup Project</a></li>
<li><a class="reference internal" href="#setup-docker">Setup Docker</a></li>
<li><a class="reference internal" href="#setup-minikube">Setup minikube</a></li>
<li><a class="reference internal" href="#prepare-deployment">Prepare deployment</a></li>
<li><a class="reference internal" href="#deploy-for-development-using-skaffold">Deploy for development using Skaffold</a></li>
<li><a class="reference internal" href="#if-something-goes-wrong">If something goes wrong</a></li>
<li><a class="reference internal" href="#viewing-logs">Viewing logs</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    </body>
</html>